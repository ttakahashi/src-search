require 'nkf'
require 'pp'
@ids = {3298 => {"hit" => 0  }, 
        3305 => {"hit" => 0  },
        3307 => {"hit" => 0  },
        3308 => {"hit" => 0  },
        3312 => {"hit" => 0  },
        3313 => {"hit" => 0  },
        3314 => {"hit" => 0  },
        3316 => {"hit" => 0  },
        3317 => {"hit" => 0  },
        3968 => {"hit" => 0  },
        3979 => {"hit" => 0  },
        4025 => {"hit" => 0  },
        4026 => {"hit" => 0  },
        4028 => {"hit" => 0  },
        4029 => {"hit" => 0  },
        4140 => {"hit" => 0  },
        4143 => {"hit" => 0  },
        4144 => {"hit" => 0  },
        3356 => {"hit" => 0  },
        3357 => {"hit" => 0  },
        3358 => {"hit" => 0  },
        4258 => {"hit" => 0  },
        3361 => {"hit" => 0  },
        3500 => {"hit" => 0  },
        3501 => {"hit" => 0  },
        3502 => {"hit" => 0  },
        3503 => {"hit" => 0  },
        3504 => {"hit" => 0  },
        3505 => {"hit" => 0  },
        3506 => {"hit" => 0  },
        3507 => {"hit" => 0  },
        3508 => {"hit" => 0  },
        3509 => {"hit" => 0  },
        3510 => {"hit" => 0  },
        3511 => {"hit" => 0  },
        3512 => {"hit" => 0  },
        3513 => {"hit" => 0  },
        3514 => {"hit" => 0  },
        3515 => {"hit" => 0  },
        3516 => {"hit" => 0  },
        3517 => {"hit" => 0  },
        3363 => {"hit" => 0  },
        3364 => {"hit" => 0  },
        3901 => {"hit" => 0  },
        3969 => {"hit" => 0  },
        3970 => {"hit" => 0  },
        3971 => {"hit" => 0  },
        3972 => {"hit" => 0  },
        3973 => {"hit" => 0  },
        3974 => {"hit" => 0  },
        3975 => {"hit" => 0  },
        3976 => {"hit" => 0  },
        3977 => {"hit" => 0  },
        3978 => {"hit" => 0  },
        3984 => {"hit" => 0  },
        3985 => {"hit" => 0  },
        3986 => {"hit" => 0  },
        3987 => {"hit" => 0  },
        3988 => {"hit" => 0  },
        3989 => {"hit" => 0  },
        3990 => {"hit" => 0  },
        3991 => {"hit" => 0  },
        3992 => {"hit" => 0  },
        3993 => {"hit" => 0  },
        3996 => {"hit" => 0  },
        3997 => {"hit" => 0  },
        3998 => {"hit" => 0  },
        3999 => {"hit" => 0  },
        4000 => {"hit" => 0  },
        4001 => {"hit" => 0  },
        4002 => {"hit" => 0  },
        4003 => {"hit" => 0  },
        4004 => {"hit" => 0  },
        4005 => {"hit" => 0  },
        4193 => {"hit" => 0  },
        4194 => {"hit" => 0  },
        4195 => {"hit" => 0  },
        4196 => {"hit" => 0  },
        4197 => {"hit" => 0  },
        4198 => {"hit" => 0  },
        4199 => {"hit" => 0  },
        4200 => {"hit" => 0  },
        4201 => {"hit" => 0  },
        4202 => {"hit" => 0  },
        4203 => {"hit" => 0  },
        4204 => {"hit" => 0  },
        4205 => {"hit" => 0  },
        4206 => {"hit" => 0  },
        4207 => {"hit" => 0  },
        4208 => {"hit" => 0  },
        4209 => {"hit" => 0  },
        4210 => {"hit" => 0  },
        4211 => {"hit" => 0  },
        4212 => {"hit" => 0  },
        4213 => {"hit" => 0  },
        4214 => {"hit" => 0  },
        4215 => {"hit" => 0  },
        4216 => {"hit" => 0  },
        4264 => {"hit" => 0  },
        4265 => {"hit" => 0  },
        4266 => {"hit" => 0  },
        4144 => {"hit" => 0  },
        5656 => {"hit" => 0  },
        6009 => {"hit" => 0  },
        6010 => {"hit" => 0  },
        6011 => {"hit" => 0  },
        6012 => {"hit" => 0  },
        6013 => {"hit" => 0  },
        6014 => {"hit" => 0  },
        6015 => {"hit" => 0  },
        6016 => {"hit" => 0  },
        6017 => {"hit" => 0  },
        6018 => {"hit" => 0  },
        6019 => {"hit" => 0  },
        6020 => {"hit" => 0  },
        6021 => {"hit" => 0  },
        6024 => {"hit" => 0  },
        6686 => {"hit" => 0  },
        4522 => {"hit" => 0  },
        4562 => {"hit" => 0  },
        4564 => {"hit" => 0  },
        4566 => {"hit" => 0  },
        4567 => {"hit" => 0  },
        4569 => {"hit" => 0  },
        4571 => {"hit" => 0  },
        4572 => {"hit" => 0  },
        4573 => {"hit" => 0  },
        4574 => {"hit" => 0  },
        4575 => {"hit" => 0  },
        4576 => {"hit" => 0  },
        4577 => {"hit" => 0  },
        4583 => {"hit" => 0  },
        4584 => {"hit" => 0  },
        4587 => {"hit" => 0  },
        4588 => {"hit" => 0  },
        4589 => {"hit" => 0  },
        4571 => {"hit" => 0  },
        4597 => {"hit" => 0  },
        4610 => {"hit" => 0  },
        4612 => {"hit" => 0  },
        5114 => {"hit" => 0  },
        5116 => {"hit" => 0  },
        5118 => {"hit" => 0  },
        5120 => {"hit" => 0  },
        5122 => {"hit" => 0  },
        5124 => {"hit" => 0  },
        5126 => {"hit" => 0  },
        5128 => {"hit" => 0  },
        5130 => {"hit" => 0  },
        5132 => {"hit" => 0  },
        5143 => {"hit" => 0  },
        4532 => {"hit" => 0  },
        4533 => {"hit" => 0  },
        4534 => {"hit" => 0  },
        4535 => {"hit" => 0  },
        4536 => {"hit" => 0  },
        4537 => {"hit" => 0  },
        4538 => {"hit" => 0  },
        4539 => {"hit" => 0  },
        4540 => {"hit" => 0  },
        4541 => {"hit" => 0  },
        4542 => {"hit" => 0  },
        4543 => {"hit" => 0  },
        4544 => {"hit" => 0  },
        4545 => {"hit" => 0  },
        4546 => {"hit" => 0  },
        4547 => {"hit" => 0  },
        4548 => {"hit" => 0  },
        4549 => {"hit" => 0  },
        4550 => {"hit" => 0  },
        4551 => {"hit" => 0  },
        4552 => {"hit" => 0  },
        4553 => {"hit" => 0  },
        4554 => {"hit" => 0  },
        4555 => {"hit" => 0  },
        4556 => {"hit" => 0  }, 
        4557 => {"hit" => 0  },
        4558 => {"hit" => 0  },
        4559 => {"hit" => 0  },
        4560 => {"hit" => 0  },
        4561 => {"hit" => 0  },
        4595 => {"hit" => 0  },
}


def process_file(filename)
  io = File.open(filename, "rb"){ |io|
    while line = io.gets
      line = NKF.nkf("-d -w", line)
      @ids.keys.each{ |id|
        hit = line.index("id=" + id.to_s)
        unless hit == nil
          if hit > 0
            @ids[id]["hit"] += 1
            if @ids[id][:file] == nil
              @ids[id][:file] = Array.new(0)
            end
            @ids[id][:file].push(filename)
          end
        end
      }
    end
  }
end


Dir.glob("/PATH/TO/DIR/**/*.as").each{ |filename|
  unless FileTest.directory?(filename)
p filename
    process_file(filename)
  end
}


io = open("_result", "w")
io.write(@ids)
pp @ids
